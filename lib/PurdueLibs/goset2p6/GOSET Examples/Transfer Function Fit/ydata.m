% SSFR Impedance Data of Brusless DC Machine
% Rotor is aligned with d-axis.  

% frequency vector
f = [20 23 25 29 32 37 41 47 53 59 67 76 85 96 109 123 138 ...
   156 176 199 224 253 286 322 364 410 463 523 590 666 751 ...
   848 957 1079 1218 1375 1551 1750 1975 2229 2516 2839 ...
   3203 3615 4079 4603 5195 5862 6615 7465 8424 9506 10728 ...
   12106 13661 15416 17397 19632 22154 25000];

% resistance measurement from LCR meter
r_lcr=[3.494 3.517 3.533 3.566 3.594 3.64 3.679 3.74 3.804 ...
       3.871 3.964 4.078 4.193 4.329 4.503 4.7 4.916 5.185 5.493 ...
       5.861 6.268 6.753 7.317 7.939 8.685 9.494 10.457 11.523 ...
       12.768 14.193 15.74 17.512 19.651 21.868 24.627 27.256 31.01 ...
       34.455 38.79 43.689 48.77 55.253 61.25 69.14 77.31 89.04 ...
       100.39 114.58 126.56 144.22 160.26 185.05 206.62 232.2 265.52 ...
       307.6 352.7 408.7 465.6 544];

% inductance measurement from LCR meter
l_lcr=[20.781 20.751 20.697 20.638 20.585 20.518 20.457 20.379 ...
       20.301 20.232 20.144 20.05 19.942 19.839 19.728 19.613 19.498 ...
       19.367 19.23 19.08 18.93 18.767 18.593 18.419 18.231 18.044 ...
       17.843 17.64 17.428 17.208 16.996 16.777 16.536 16.322 16.079 ...
       15.874 15.614 15.403 15.165 14.928 14.711 14.466 14.264 14.03 ...
       13.815 13.546 13.323 13.076 12.895 12.664 12.482 12.243 12.077 ...
       11.911 11.739 11.579 11.46 11.364 11.31 11.285]*1e-3;

% convert to d-axis admittance
s=1j*2*pi*f;     % Complex frequency
rd=2*r_lcr/3;    % D-Axis Resistance
ld=2*l_lcr/3;    % D-Axis Inductance
zd=rd+s.*ld;     % D-Axis Impedance
yd=1./zd;        % D-Axis Admittance